{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}">
<link rel="stylesheet" href="{% static 'css/studentpanel.css' %}">
<link rel="stylesheet" href="{% static 'css/teacherpanel.css' %}">
{% endblock %}

{% block content %}
<div class="teacher-panel-container">
    <div class="sidebar">
        <div class="sidebar-header">
            <h3>Actions</h3>
        </div>

        <div class="sidebar-menu">
            <ul>
                <li><button id="your-work-btn">Your Work</button></li>
                <li><button id="global-work-btn">Reports</button></li>
            </ul>

        </div>
    </div>
    <div class="main-content">
        <div class="teacher-panel-header">

            <h1 id="panel-title">Your Work</h1>
            <form action="{% url 'logout' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-info">Logout</button>
            </form>
        </div>
        
        <ul class="file-list" id="file-list">
            {% for file in user_uploaded_files %}
            <li>
                <a href="{{ file.file.url }}" target="_blank">{{ file.file.name }}</a>
            </li>
            {% endfor %}
        </ul>
        <div class="upload-section">
            <h2>Upload Report</h2>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit">Upload</button>
            </form>
        </div>
    </div>
</div>

<script>
    document.getElementById('your-work-btn').addEventListener('click', function () {
        document.getElementById('panel-title').textContent = 'Your Work';
        document.getElementById('file-list').innerHTML = '';
        {% for file in user_uploaded_files %}
        var li = document.createElement('li');
        var a = document.createElement('a');
        a.href = '{{ file.file.url }}';
        a.target = '_blank';
        a.textContent = '{{ file.file.name }}';
        li.appendChild(a);
        document.getElementById('file-list').appendChild(li);
        {% endfor %}
    });

    document.getElementById('global-work-btn').addEventListener('click', function () {
        document.getElementById('panel-title').textContent = 'Reports';
        document.getElementById('file-list').innerHTML = '';
        {% for file in all_uploaded_files %}
        var li = document.createElement('li');
        var a = document.createElement('a');
        a.href = '{{ file.file.url }}';
        a.target = '_blank';
        a.textContent = '{{ file.file.name }}';
        var span = document.createElement('span');
        span.textContent = 'Owner: {{ file.user.username }}';
        li.appendChild(a);
        li.appendChild(span);
        document.getElementById('file-list').appendChild(li);
        {% endfor %}
    });
</script>
{% endblock %}